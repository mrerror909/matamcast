// Ø¯ÙˆØ§Ù„ Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
        async function exportAuditLog() {
            try {
                const exportData = {
                    metadata: {
                        exportDate: new Date().toISOString(),
                        totalEntries: auditLog.length,
                        sessionId: window.sessionId,
                        version: '2.0'
                    },
                    entries: auditLog.map(entry => ({
                        ...entry,
                        timestamp: entry.timestamp.toISOString ? entry.timestamp.toISOString() : entry.timestamp
                    }))
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { 
                    type: 'application/json' 
                });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `audit-log-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                addAuditEntry('ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·', `ØªÙ… ØªØµØ¯ÙŠØ± ${auditLog.length} Ø­Ø¯Ø«`);
                showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·', 'success');
                logDebug('success', 'ğŸ“Š ØªÙ… ØªØµØ¯ÙŠØ± Ø³Ø¬Ù„ Ø§Ù„Ù†Ø´Ø§Ø·');
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØµ        // Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù€ API
        function initSmartApiSystem() {
            // Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø§Ù„Ù‚Ù†ÙˆØ§Øª
            calculateChannelPriorities();
            
            // Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
            if (smartApiEnabled && apiCallCount < 950) {
                scheduleSmartUpdates();
            }
            
            logDebug('success', 'ğŸ§  ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ Ù„Ø¥Ø¯Ø§Ø±Ø© API');
        }
        
        function calculateChannelPriorities() {
            channelPriorities.clear();
            
            channels.forEach(channel => {
                let priority = 0;
                
                // Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
                if (channel.status === 'live') priority += 100;
                else if (channel.status === 'upcoming') priority += 50;
                
                // Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„ØªÙŠ ØªØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ«
                if (channel.needsApiUpdate) priority += 30;
                
                // Ø£ÙˆÙ„ÙˆÙŠØ© Ø­Ø³Ø¨ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«
                if (channel.lastUpdated) {
                    const daysSinceUpdate = (Date.now() - channel.lastUpdated.toDate().getTime()) / (1000 * 60 * 60 * 24);
                    if (daysSinceUpdate > 1) priority += Math.min(daysSinceUpdate * 5, 25);
                }
                
                // Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù„Ù‚Ù†ÙˆØ§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©
                if (channel.subscriberCount) {
                    const subs = parseInt(channel.subscriberCount);
                    if (subs > 1000000) priority += 20; // Ù…Ù„ÙŠÙˆÙ†+
                    else if (subs > 100000) priority += 10; // 100K+
                    else if (subs > 10000) priority += 5; // 10K+
                }
                
                channelPriorities.set(channel.id, priority);
            });
            
            logDebug('success', `ğŸ¯ ØªÙ… Ø­Ø³Ø§Ø¨ Ø£ÙˆÙ„ÙˆÙŠØ§Øª ${channelPriorities.size} Ù‚Ù†Ø§Ø©`);
        }
        
        async function scheduleSmartUpdates() {
            if (apiCallCount > 900) {
                logDebug('warning', 'âš  ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ© - Ø­ØµØ© API Ù…Ù†Ø®ÙØ¶Ø©');
                return;
            }
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù‚Ù†ÙˆØ§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©
            const sortedChannels = [...channels].sort((a, b) => {
                return (channelPriorities.get(b.id) || 0) - (channelPriorities.get(a.id) || 0);
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ù‡Ù… 5-10 Ù‚Ù†ÙˆØ§Øª
            const channelsToUpdate = sortedChannels.slice(0, Math.min(10, Math.floor((1000 - apiCallCount) / 5)));
            
            if (channelsToUpdate.length > 0) {
                logDebug('success', `ğŸ”„ Ø¬Ø¯ÙˆÙ„Ø© ØªØ­Ø¯ÙŠØ« Ø°ÙƒÙŠ Ù„Ù€ ${channelsToUpdate.length} Ù‚Ù†Ø§Ø©`);
                
                const apiKey = await getApiKey();
                if (apiKey) {
                    for (let channel of channelsToUpdate) {
                        if (apiCallCount > 950) break;
                        
                        try {
                            await updateChannelFromAPI(channel, apiKey);
                            await new Promise(resolve => setTimeout(resolve, 200)); // ØªØ£Ø®ÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                        } catch (error) {
                            logDebug('error', `âœ— ÙØ´Ù„ ØªØ­Ø¯ÙŠØ« Ù‚Ù†Ø§Ø©: ${error.message}`);
                        }
                    }
                }
            }
            
            lastSmartUpdate = Date.now();
        }
        
        function updateSmartApiDisplay() {
            const smartApiStatus = document.getElementById('smartApiStatus');
            if (!smartApiStatus || !debugMode) return;
            
            const nextUpdateIn = Math.max(0, Math.ceil((lastSmartUpdate + 300000 - Date.now()) / 60000)); // 5 Ø¯Ù‚Ø§Ø¦Ù‚
            const highPriorityChannels = [...channelPriorities.entries()]
                .filter(([id, priority]) => priority > 50)
                .length;
            
            const apiBudget = Math.max(0, 1000 - apiCallCount);
            const estimatedUpdates = Math.floor(apiBudget / 5);
            
            let statusColor = 'debug-success';
            let statusIcon = 'ğŸŸ¢';
            let statusText = 'Ù…Ø«Ø§Ù„ÙŠ';
            
            if (apiCallCount > 900) {
                statusColor = 'debug-error';
                statusIcon = 'ğŸ”´';
                statusText = 'Ù…ØªÙˆÙ‚Ù - Ø­ØµØ© Ù…Ù†Ø®ÙØ¶Ø©';
            } else if (apiCallCount > 800) {
                statusColor = 'debug-warning';
                statusIcon = 'ğŸŸ¡';
                statusText = 'Ù…Ø­Ø°Ø± - Ø§Ø³ØªÙ‡Ù„Ø§Ùƒ Ø¹Ø§Ù„ÙŠ';
            }
            
            smartApiStatus.innerHTML = `
                <div class="${statusColor}">
                    ${statusIcon} Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…: ${statusText}
                </div>

            <div class="section-card">
                <div class="section-header">
                    <div class="section-title-group">
                        <i class="fas fa-cog"></i>
                        <h3 class="section-title">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª YouTube API</h3>
                    </div>
                </div>
                <div class="section-content">
                    <div class="settings-grid">
                        <input type="text" id="ytKey" class="settings-input" placeholder="YouTube API Key">
                        <button class="btn btn-save" onclick="saveKey()">
                            <i class="fas fa-save"></i>
                            Ø­ÙØ¸
                        </button>
                    </div>
                    <div class="settings-grid">
                        <div></div>
                        <button class="test-api-btn" onclick="testYouTubeAPI()">
                            <i class="fas fa-flask"></i>
                            Ø§Ø®ØªØ¨Ø§Ø± API
                        </button>
                    </div>
                </div>
            </div>
                <div class="debug-success">ğŸ¯ Ù‚Ù†ÙˆØ§Øª Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©: ${highPriorityChannels}</div>
                <div class="debug-success">ğŸ’° Ù…ÙŠØ²Ø§Ù†ÙŠØ© API Ù…ØªØ¨Ù‚ÙŠØ©: ${apiBudget} (â‰ˆ${estimatedUpdates} ØªØ­Ø¯ÙŠØ«)</div>
                <div class="debug-success">â° Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ù„ÙŠ Ø®Ù„Ø§Ù„: ${nextUpdateIn} Ø¯Ù‚ÙŠÙ‚Ø©</div>
                <div class="debug-success">ğŸ”„ Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ« Ø°ÙƒÙŠ: ${lastSmartUpdate ? formatTimeAgo(lastSmartUpdate) : 'Ù„Ù… ÙŠØªÙ… Ø¨Ø¹Ø¯'}</div>
            `;
        }
        
        function formatTimeAgo(timestamp) {
            const minutes = Math.floor((Date.now() - timestamp) / 60000);
            if (minutes < 1) return 'Ø§Ù„Ø¢Ù†';
            if (minutes < 60) return `${minutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
            const hours = Math.floor(minutes / 60);
            return `${hours} Ø³Ø§Ø¹Ø©`;
        }
        
        // ØªØ­Ø³ÙŠÙ† Ù…Ø±Ø§Ù‚Ø¨ API Ù„ÙŠØ´Ù…Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©
        function updateApiMonitor() {
            if (!debugMode) return;
            
            const now = Date.now();
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯ ÙƒÙ„ Ø³Ø§Ø¹Ø©
            if (now - lastApiReset > 3600000) {
                apiCallCount = 0;
                lastApiReset = now;
                logDebug('success', 'ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¹Ø¯Ø§Ø¯ API (Ø³Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©)');
                addAuditEntry('Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† API', 'Ø¨Ø¯Ø§ÙŠØ© Ø³Ø§Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©');
            }
            
            const remaining = Math.max(0, 1000 - apiCallCount);
            const hitRate = totalRequests > 0 ? Math.round((cacheHits / totalRequests) * 100) : 0;
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø±Ù‚Ø§Ù…
            document.getElementById('apiCallsCount').textContent = apiCallCount;
            document.getElementById('apiQuotaRemaining').textContent = remaining;
            document.getElementById('cacheHitRate').textContent = hitRate + '%';
            document.getElementById('cacheSizeDisplay').textContent = cacheStats.size;
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
            const callsElement = document.getElementById('apiCallsCount');
            const remainingElement = document.getElementById('apiQuotaRemaining');
            
            // Ø¥Ø´Ø§Ø±Ø§Øª ØªØ­Ø°ÙŠØ±ÙŠØ© Ù„Ù„Ø­ØµØ© Ù…Ø¹ Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø°ÙƒÙŠØ©
            const warningDiv = document.getElementById('apiQuotaWarning');
            warningDiv.innerHTML = '';
            
            if (apiCallCount > 950) {
                callsElement.style.color = '#dc3545';
                remainingElement.style.color = '#dc3545';
                warningDiv.innerHTML = `
                    <div class="api-quota-danger">
                        <i class="fas fa-exclamation-triangle"></i> 
                        <strong>ØªØ­Ø°ÙŠØ± Ø­Ø±Ø¬:</strong> ÙˆØ´Ùƒ Ù†ÙØ§Ø¯ Ø­ØµØ© API!
                        <br><small>ğŸ’¡ Ø§Ù„Ø­Ù„ÙˆÙ„: Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø³Ø§Ø¹Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©ØŒ Ø§Ù„Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¹Ù„Ù‰ Ø§Ù„ÙƒØ§Ø´ØŒ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…ÙØªØ§Ø­ API Ø¥Ø¶Ø§ÙÙŠ</small>
                    </div>
                `;
                disableApiFeatures(true);
                smartApiEnabled = false;
            } else if (apiCallCount > 800) {
                callsElement.style.color = '#ffc107';
                remainingElement.style.color = '#ffc107';
                const estimatedTime = Math.ceil((1000 - apiCallCount) / 10); // ØªÙ‚Ø¯ÙŠØ± Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ø¨Ø§Ù„Ø¯Ù‚Ø§Ø¦Ù‚
                warningDiv.innerHTML = `
                    <div class="api-quota-warning">
                        <i class="fas fa-exclamation-circle"></i> 
                        <strong>ØªØ­Ø°ÙŠØ±:</strong> Ø­ØµØ© API Ù…Ù†Ø®ÙØ¶Ø© (${remaining} Ù…ØªØ¨Ù‚ÙŠØ©)
                        <br><small>ğŸ’¡ Ø³ÙŠØªÙ… Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø§Ù„Ù‚Ù†ÙˆØ§Øª        async function addChannelQuick() {
            const channelInput = document.getElementById('quickChannelUrl').value.trim();
            
            if (!channelInput) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„Ù‚Ù†Ø§Ø© Ø£Ùˆ Ø§Ù„Ù…Ø¹Ø±Ù', 'error');
                logDebug('error', 'âœ— Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙØ© Ù‚Ù†Ø§Ø© Ø¨Ø¯ÙˆÙ† Ø±Ø§Ø¨Ø·');
                return;
            }
            
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù…Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ø±Ø§Ø¨Ø· ÙƒØ§Ù…Ù„ Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
            const fullUrl = normalizeChannelInput(channelInput);
            if (!fullUrl) {
                showNotification('ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©. Ø§Ø³ØªØ®Ø¯Ù… Ø±Ø§Ø¨Ø· ÙƒØ§Ù…Ù„ Ø£Ùˆ @username Ø£Ùˆ Ù…Ø¹Ø±Ù Ø§Ù„Ù‚Ù†Ø§Ø©', 'error');
                logDebug('error', `âœ— ØµÙŠØºØ© ØºÙŠØ± ØµØ­ÙŠØ­Ø©: ${channelInput}`);
                return;
            }
            
            try {
                showNotification('Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‚Ù†Ø§Ø©...', 'success');
                logDebug('success', `ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ù†Ø§Ø©: ${channelInput}`);
                
                // Ø¬Ù„Ø¨ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù‚Ù†Ø§Ø© Ù…Ù† YouTube API
                const apiKey = await getApiKey();
                if (!apiKey) {
                    showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…ÙØªØ§Ø­ YouTube API. Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'warning');
                    await addChannelWithoutAPI(fullUrl, channelInput);
                    return;
                }
                
                if (apiCallCount > 950) {
                    showNotification('Ø­ØµØ© API Ù…Ù†Ø®ÙØ¶Ø©. Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø¹Ù„ÙˆÙ…Ø§Øª', 'warning');
                    await addChannelWithoutAPI(fullUrl, channelInput);
                    return;
                }
                
                const channelData = await fetchChannelDataFromInput(channelInput, apiKey);
                
                if (channelData) {
                    await addChannelWithData(channelData, fullUrl);
                } else {
                    await addChannelWithoutAPI(fullUrl, channelInput);
                }
                
                document.getElementById('quickChannelUrl').value = '';
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø©:', error);
                logDebug('error', `âœ— Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø©: ${error.message}`);
                showNotification('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‚Ù†Ø§Ø©', 'error');
            }
        }
